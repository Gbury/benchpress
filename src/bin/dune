(executable
 (name benchpress_bin)
 (public_name benchpress)
 (libraries benchpress containers cmdliner result toml uuidm logs logs.cli
            tiny_httpd tyxml printbox.html sqlite3_utils base64
            benchpress.api)
 (flags :standard -warn-error -3-32 -safe-string -open Benchpress))

(rule
  (targets css.ml)
  (deps basic.css)
  (action
    (with-stdout-to %{targets}
     (progn
       (echo "let css = {css|")
       (cat %{deps})
       (echo "|css}")))))

(rule
 (with-stdout-to benchpress.1 (run ./benchpress_bin.exe --help=groff)))

(rule
 (with-stdout-to benchpress-run.1 (run ./benchpress_bin.exe run --help=groff)))

(rule
 (with-stdout-to benchpress-serve.1 (run ./benchpress_bin.exe serve --help=groff)))

(install
 (section man)
 (package benchpress)
 (files benchpress.1 benchpress-run.1 benchpress-serve.1))

